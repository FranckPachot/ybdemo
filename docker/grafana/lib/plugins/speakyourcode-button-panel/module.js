define(["@grafana/data","@grafana/runtime","@grafana/ui","react"],((e,t,n,r)=>(()=>{"use strict";var a={305:t=>{t.exports=e},545:e=>{e.exports=t},388:e=>{e.exports=n},650:e=>{e.exports=r}},o={};function l(e){var t=o[e];if(void 0!==t)return t.exports;var n=o[e]={exports:{}};return a[e](n,n.exports,l),n.exports}l.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return l.d(t,{a:t}),t},l.d=(e,t)=>{for(var n in t)l.o(t,n)&&!l.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var u={};return(()=>{l.r(u),l.d(u,{plugin:()=>f});var e=l(305),t=l(545),n=l(388),r=l(650),a=l.n(r);function o(e,t,n,r,a,o,l){try{var u=e[o](l),i=u.value}catch(e){return void n(e)}u.done?t(i):Promise.resolve(i).then(r,a)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var l=e.apply(t,n);function u(e){o(l,r,a,u,i,"next",e)}function i(e){o(l,r,a,u,i,"throw",e)}u(void 0)}))}}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){c(e,t,n[t])}))}return e}function p(){return(p=i((function*(n,r,a){const o=JSON.parse(a(n.query||"{}")),l=yield(0,t.getDataSourceSrv)().get(n.datasource),u=(0,t.getAppEvents)();try{const n=yield(0,t.getBackendSrv)().datasourceRequest({method:"POST",url:"api/ds/query",data:{queries:[s({datasourceId:l.id,refId:"1"},o)]}});u.publish({type:e.AppEvents.alertSuccess.name,payload:[r+": "+n.status+" ("+n.statusText+")"]})}catch(t){u.publish({type:e.AppEvents.alertError.name,payload:[r+": "+t.status+" ("+t.statusText+") "+t.data.message]})}}))).apply(this,arguments)}function d(e,t,n,r,a,o,l){try{var u=e[o](l),i=u.value}catch(e){return void n(e)}u.done?t(i):Promise.resolve(i).then(r,a)}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const y=({buttons:e,onChange:r})=>{const[o,l]=a().useState(),[u,i]=a().useState(e.map((e=>!1))),[c,s]=a().useState(e);a().useEffect((()=>{let e=!1;var n,r;return(n=function*(){const n=yield(0,t.getBackendSrv)().get("/api/datasources");e||l(n.map((e=>({label:e.name,value:e.name,name:e.name}))))},r=function(){var e=this,t=arguments;return new Promise((function(r,a){var o=n.apply(e,t);function l(e){d(o,r,a,l,u,"next",e)}function u(e){d(o,r,a,l,u,"throw",e)}l(void 0)}))},function(){return r.apply(this,arguments)})(),()=>{e=!0}}),[]);const p=(e,t)=>{let n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){v(e,t,n[t])}))}return e}({},c[e]);s([...c.slice(0,e),{text:t.text||n.text,datasource:t.datasource||n.datasource,query:t.query||n.query,variant:t.variant||n.variant},...c.slice(e+1)])};return a().createElement(a().Fragment,null,c.map(((t,l)=>a().createElement(n.Collapse,{key:l,label:"Button "+(l+1).toString(),isOpen:u[l],collapsible:!0,onToggle:()=>{i((e=>[...e.slice(0,l),!e[l],...e.slice(l+1)]))}},a().createElement(n.Field,{label:"Text",description:"Text to be displayed on the button"},a().createElement(n.Input,{id:"t-"+l.toString(),value:t.text,placeholder:"Button",onChange:e=>p(l,{text:e.target.value})})),a().createElement(n.Field,{label:"Datasource",description:"Choose the Datasource for the query"},a().createElement(n.Select,{onChange:e=>p(l,{datasource:e.value}),value:t.datasource,options:o})),a().createElement(n.Field,{label:"Query",description:"JSON query to be triggered on Button Click"},a().createElement(n.TextArea,{id:"q-"+l.toString(),value:t.query,placeholder:"{ query: 'your query' }",rows:5,onChange:e=>p(l,{query:e.target.value})})),a().createElement(n.Field,{label:"Color",description:"Color of the button"},a().createElement(n.RadioButtonGroup,{options:[{label:"Primary",value:"primary"},{label:"Secondary",value:"secondary"},{label:"Destructive",value:"destructive"},{label:"Link",value:"link"}],value:t.variant||"primary",fullWidth:!0,onChange:e=>p(l,{variant:e})})),a().createElement(n.Field,null,a().createElement(a().Fragment,null,a().createElement(n.Button,{icon:"trash-alt",variant:"destructive",onClick:()=>r([...e.slice(0,l),...e.slice(l+1)])},"Delete"),a().createElement(n.Button,{icon:"save",variant:"primary",onClick:()=>r(c)},"Apply")))))),a().createElement(n.Field,null,a().createElement(n.Button,{variant:"secondary",icon:"plus",size:"sm",onClick:()=>{r([...e,{text:"",datasource:"",query:""}])}},"Add Button")))},f=new e.PanelPlugin((({options:e,replaceVariables:t})=>{const r=e=>e.map(((e,r)=>{const o=e.text||"Button";return a().createElement(n.Button,{key:r,variant:e.variant,onClick:i((function*(){return function(e,t,n){return p.apply(this,arguments)}(e,o,t)}))},o)}));return"vertical"===e.orientation&&a().createElement(n.VerticalGroup,{justify:"center",align:"center"},r(e.buttons))||a().createElement(n.HorizontalGroup,{justify:"center",align:"center"},r(e.buttons))}));f.setPanelOptions((e=>function(e){e.addRadio({path:"orientation",name:"Orientation",description:"Stacking direction in case of multiple buttons",defaultValue:"horizontal",settings:{options:[{value:"horizontal",label:"Horizontal"},{value:"vertical",label:"Vertical"}]}}).addCustomEditor({id:"buttons",path:"buttons",name:"Button Configuration",defaultValue:[{text:"",datasource:"",query:""}],editor:e=>a().createElement(y,{buttons:e.value,onChange:e.onChange})})}(e)))})(),u})()));
//# sourceMappingURL=module.js.map